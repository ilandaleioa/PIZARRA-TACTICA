<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>AC Center ‚Äì Pizarra T√°ctica</title>
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
  <link rel="stylesheet" href="styles.css?v=22" />
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  TOP NAV  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<header class="topnav">
    <script src="app.js?v=105"></script>
    <div class="nav-logo-wrap" title="Haz clic para subir el escudo" onclick="document.getElementById('nav-logo-input').click()">
      <img id="nav-logo-img" src="ACFC Blanco Cuadrado.png.png" alt="Escudo AC" style="display:block" onerror="this.style.display='none'" />
      <span id="nav-logo-placeholder" title="Subir escudo" style="display:none">&#128247;</span>
    </div>
    <input type="file" id="nav-logo-input" accept="image/*" style="display:none" onchange="loadNavLogo(event)" />
    <div class="logo-texts">
      <span class="logo-title">AC CENTER</span>
      <span class="logo-sub">PIZARRA T√ÅCTICA</span>
    </div>
  </div>
  <div class="topnav-right">
    <div class="lang-switcher">
      <button class="lang active" onclick="setLang('es')">ES</button>
      <button class="lang" onclick="setLang('eu')">EU</button>
      <button class="lang" onclick="setLang('fr')">FR</button>
      <button class="lang" onclick="setLang('en')">EN</button>
    </div>
    <button id="fullscreen-btn" class="icon-btn" title="Pantalla completa" onclick="toggleFullscreen()">&#x26F6;</button>
    <button id="theme-btn" class="icon-btn theme-toggle-btn" title="Cambiar tema" onclick="toggleTheme()">&#9728;</button>
    <button class="icon-btn" title="Ajustes">&#9881;</button>
  </div>
</header>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  MAIN LAYOUT  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="main-layout">

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ LEFT SIDEBAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <aside class="sidebar-left">
    <button class="sidebar-tab" id="tab-plantilla" onclick="switchTab('plantilla')">
      <span class="tab-icon">&#9776;</span>
      <span data-i18n="plantilla">PLANTILLA</span>
    </button>
    <button class="sidebar-tab active" id="tab-pizarra" onclick="switchTab('pizarra')">
      <span class="tab-icon">&#9633;</span>
      <span data-i18n="pizarra">PIZARRA T√ÅCTICA</span>
    </button>

    <!-- MI EQUIPO -->
    <div class="sidebar-section" id="section-pizarra">
      <div class="section-header">
        <span class="dot red"></span>
        <span data-i18n="mi_equipo">MI EQUIPO</span>
        <button class="vis-toggle active" id="eye-my" onclick="toggleTeamVisibility('my')">
          <span class="vis-icon">&#128065;</span><span class="vis-label">VISIBLE</span>
        </button>
      </div>
      <div id="my-team">
        <select class="formation-select" id="my-formation" onchange="applyFormation('my')">
          <option value="1-4-4-2">1-4-4-2</option>
          <option value="1-4-3-3">1-4-3-3</option>
          <option value="1-4-2-3-1">1-4-2-3-1</option>
          <option value="1-3-5-2">1-3-5-2</option>
          <option value="1-3-4-3">1-3-4-3</option>
          <option value="1-5-3-2">1-5-3-2</option>
          <option value="1-5-4-1">1-5-4-1</option>
        </select>

      </div>

      <!-- EQUIPO RIVAL -->
      <div class="section-header" style="margin-top:22px">
        <span class="dot blue"></span>
        <span data-i18n="equipo_rival">EQUIPO RIVAL</span>
        <button class="vis-toggle" id="eye-rival" onclick="toggleTeamVisibility('rival')">
          <span class="vis-icon">&#128065;</span><span class="vis-label">OCULTO</span>
        </button>
      </div>
      <div id="rival-team">
        <select class="formation-select" id="rival-formation" onchange="applyFormation('rival')">
          <option value="1-4-4-2">1-4-4-2</option>
          <option value="1-4-3-3">1-4-3-3</option>
          <option value="1-4-2-3-1">1-4-2-3-1</option>
          <option value="1-3-5-2">1-3-5-2</option>
          <option value="1-3-4-3">1-3-4-3</option>
          <option value="1-5-3-2">1-5-3-2</option>
          <option value="1-5-4-1">1-5-4-1</option>
        </select>

      </div>

      <!-- ACTION BUTTONS -->
      <div class="action-row">
        <button class="action-btn" onclick="exportImage()">&#128247; <span data-i18n="imagen">IMAGEN</span></button>
        <button class="action-btn" onclick="exportVideo()">&#127909; <span data-i18n="video">VIDEO</span></button>
      </div>
      <div class="action-row">
        <button class="action-btn secondary" onclick="undo()">&#8617; <span data-i18n="deshacer">DESHACER</span></button>
        <button class="action-btn secondary" onclick="share()">&#10143; <span data-i18n="compartir">COMPARTIR</span></button>
      </div>
      <div class="action-row">
        <button class="action-btn full" id="btn-photo-mode" onclick="togglePhotoMode()" title="Mostrar fotos de jugadores">&#128100; <span>FOTOS JUGADORES</span></button>
      </div>
      <div class="action-row">
        <button class="action-btn danger full" onclick="resetBoard()">&#9632; <span data-i18n="resetear">RESETEAR</span></button>
        <button class="action-btn secondary full" onclick="quitarJugadores()">üßπ <span>QUITAR JUGADORES</span></button>
      </div>
    </div>

    <!-- PLANTILLA TAB CONTENT (hidden by default) -->
    <div class="sidebar-section hidden" id="section-plantilla">
      <p class="placeholder-text" data-i18n="plantilla_desc">Gestiona tu plantilla de jugadores.</p>
    </div>
  </aside>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CENTER AREA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <main class="center-area">

    <!-- Slide controls -->
    <div class="slide-controls">
      <button class="slide-btn play" id="btn-play" onclick="playAnimation()" title="Reproducir">&#9654;</button>
      <button class="slide-btn add"  onclick="addSlide()" title="A√±adir fotograma">&#43;</button>
      <select class="speed-select" id="anim-speed" title="Velocidad de animaci√≥n">
        <option value="2000">&#x1F422; Lenta</option>
        <option value="1000" selected>Normal</option>
        <option value="500">&#9889; R√°pida</option>
        <option value="250">&#9889;&#9889; Muy r√°pida</option>
      </select>
      <div class="slide-chips" id="slide-chips"></div>
    </div>

    <!-- Pitch wrapper -->
    <div class="pitch-wrapper">
      <div class="pitch" id="pitch">

        <!-- Pitch markings (SVG overlay) -->
        <svg class="pitch-lines" viewBox="0 0 760 520" preserveAspectRatio="none">
          <!-- Outer border -->
          <rect x="30" y="18" width="700" height="484" fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <!-- Halfway line -->
          <line x1="30" y1="260" x2="730" y2="260" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <!-- Centre circle (dot only ‚Äì real circle drawn via CSS overlay) -->
          <circle cx="380" cy="260" r="4" fill="rgba(255,255,255,0.92)"/>
          <!-- Top penalty area -->
          <rect x="175" y="18" width="410" height="85" fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <!-- Top 6-yard box -->
          <rect x="268" y="18" width="224" height="38" fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <!-- Top goal -->
          <rect x="308" y="0" width="144" height="18" fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <!-- Top penalty spot -->
          <circle cx="380" cy="85" r="3" fill="rgba(255,255,255,0.92)"/>
          <!-- Bottom penalty area -->
          <rect x="175" y="417" width="410" height="85" fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <!-- Bottom 6-yard box -->
          <rect x="268" y="464" width="224" height="38" fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <!-- Bottom goal -->
          <rect x="308" y="502" width="144" height="18" fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <!-- Bottom penalty spot -->
          <circle cx="380" cy="435" r="3" fill="rgba(255,255,255,0.92)"/>

          <!-- Corner arcs -->
          <path d="M 30 34 A 14 14 0 0 1 44 18"   fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <path d="M 716 18 A 14 14 0 0 1 730 34"  fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <path d="M 730 486 A 14 14 0 0 1 716 502" fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
          <path d="M 44 502 A 14 14 0 0 1 30 486"  fill="none" stroke="rgba(255,255,255,0.92)" stroke-width="2.2"/>
        </svg>

        <!-- Centre circle overlay ‚Äì always a perfect circle -->
        <div class="center-circle-overlay"></div>

        <!-- Player tokens rendered by JS -->
        <div id="players-container"></div>

        <!-- Bal√≥n arrastrable -->
        <div id="ball-token" class="ball-token" style="left:50%;top:50%;"></div>

        <!-- Drawing canvas overlay -->
        <canvas id="draw-canvas"></canvas>
      </div>
    </div>

  </main>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ RIGHT SIDEBAR ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <aside class="sidebar-right">
    <h3 class="assign-title" data-i18n="asignar">ASIGNAR JUGADORES A PIZARRA</h3>
    <div id="player-list"></div>
  </aside>

  <!-- ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PLANTILLA VIEW (full area) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
  <div id="plantilla-view" class="plantilla-view hidden">
    <div class="plantilla-header">
      <h2>GESTI√ìN DE PLANTILLA</h2>
    </div>
    <div id="plantilla-content"></div>
  </div>

</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  MOBILE BOTTOM NAV  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<nav class="mobile-bottom-nav" id="mobile-bottom-nav">
  <button class="mbn-btn" id="mbn-left" onclick="toggleMobilePanel('left')">
    <span class="mbn-icon">&#9776;</span>
    <span class="mbn-label">EQUIPO</span>
  </button>
  <button class="mbn-btn active" id="mbn-pitch" onclick="closeMobilePanels()">
    <span class="mbn-icon">&#9633;</span>
    <span class="mbn-label">PIZARRA</span>
  </button>
  <button class="mbn-btn" id="mbn-plantillas" onclick="toggleMobilePlantilla()">
    <span class="mbn-icon">&#128203;</span>
    <span class="mbn-label">PLANTILLAS</span>
  </button>
  <button class="mbn-btn" id="mbn-right" onclick="toggleMobilePanel('right')">
    <span class="mbn-icon">&#128100;</span>
    <span class="mbn-label">JUGADORES</span>
  </button>
</nav>
<div class="mobile-overlay" id="mobile-overlay" onclick="closeMobilePanels()"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  MOBILE ASSIGN SHEET  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="mobile-assign-overlay" class="mobile-assign-overlay hidden" onclick="closeMobileAssignModal()">
  <div class="mobile-assign-sheet" onclick="event.stopPropagation()">
    <div class="mobile-assign-handle"></div>
    <div class="mobile-assign-header">
      <span id="mobile-assign-title">Selecciona un jugador</span>
      <button class="mobile-assign-close" onclick="closeMobileAssignModal()">&#10005;</button>
    </div>
    <div class="mobile-assign-tabs" id="mobile-assign-tabs">
      <button class="mas-tab" data-pos="portero"   onclick="setMobileAssignTab('portero')">POR</button>
      <button class="mas-tab" data-pos="defensa"   onclick="setMobileAssignTab('defensa')">DEF</button>
      <button class="mas-tab" data-pos="medio"     onclick="setMobileAssignTab('medio')">MED</button>
      <button class="mas-tab" data-pos="delantero" onclick="setMobileAssignTab('delantero')">DEL</button>
    </div>
    <div id="mobile-assign-list"></div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê  PLAYER MODAL  ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div id="player-modal-overlay" class="modal-overlay hidden" onclick="handleModalOverlayClick(event)">
  <div class="player-modal">
    <h3>PERFIL DEL JUGADOR</h3>

    <!-- FOTO HERO -->
    <div class="modal-photo-hero" onclick="document.getElementById('modal-photo-input').click()" title="Haz clic para cambiar la foto">
      <img id="modal-photo-preview" src="" alt="Foto jugador" />
      <div class="modal-photo-placeholder" id="modal-photo-placeholder">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="modal-placeholder-icon">
          <path d="M12 12c2.7 0 4.8-2.1 4.8-4.8S14.7 2.4 12 2.4 7.2 4.5 7.2 7.2 9.3 12 12 12zm0 2.4c-3.2 0-9.6 1.6-9.6 4.8v2.4h19.2v-2.4c0-3.2-6.4-4.8-9.6-4.8z"/>
        </svg>
        <span>A√ëADIR FOTO</span>
      </div>
      <div class="modal-photo-change-overlay">&#128247; CAMBIAR FOTO</div>
    </div>
    <input type="file" id="modal-photo-input" accept="image/*" onchange="previewModalPhoto(event)" style="display:none" />

    <div class="modal-fields">
      <div class="modal-field" style="width:80px">
        <label>DORSAL</label>
        <input type="number" id="modal-dorsal" min="1" max="99" />
      </div>
      <div class="modal-field" style="flex:1">
        <label>NOMBRE COMPLETO</label>
        <input type="text" id="modal-nombre" />
      </div>
      <div class="modal-field" style="width:72px">
        <label>EDAD</label>
        <input type="number" id="modal-edad" min="14" max="50" />
      </div>
    </div>

    <div class="modal-section-label">POSICI√ìN PRINCIPAL</div>
    <div class="modal-pos-grid">
      <button class="modal-pos-btn" data-pos="portero"   onclick="setModalPos('portero')">PORTERO</button>
      <button class="modal-pos-btn" data-pos="defensa"   onclick="setModalPos('defensa')">DEFENSA</button>
      <button class="modal-pos-btn" data-pos="medio"     onclick="setModalPos('medio')">MEDIO</button>
      <button class="modal-pos-btn" data-pos="delantero" onclick="setModalPos('delantero')">DELANTERO</button>
    </div>

    <div class="modal-actions">
      <button class="modal-btn cancel" onclick="closePlayerModal()">CANCELAR</button>
      <button class="modal-btn save"   onclick="savePlayerModal()">GUARDAR</button>
    </div>
  </div>
</div>

<script src="app.js?v=104"></script><script>
(function() {
  function initBall() {
    var ball = document.getElementById('ball-token');
    if (!ball) return;
    var pitch = document.getElementById('pitch');
    var bx = 50, by = 76;
    var ox, oy, pr;
    ball.addEventListener('mousedown', function(e) {
      e.preventDefault(); e.stopPropagation();
      pr = pitch.getBoundingClientRect();
      ox = e.clientX - (bx / 100 * pr.width  + pr.left);
      oy = e.clientY - (by / 100 * pr.height + pr.top);
      ball.style.cursor = 'grabbing';
      function mm(e) {
        bx = Math.min(Math.max((e.clientX - ox - pr.left) / pr.width  * 100, 1), 99);
        by = Math.min(Math.max((e.clientY - oy - pr.top)  / pr.height * 100, 1), 99);
        ball.style.left = bx + '%';
        ball.style.top  = by + '%';
      }
      function mu() {
        ball.style.cursor = 'grab';
        document.removeEventListener('mousemove', mm);
        document.removeEventListener('mouseup',   mu);
      }
      document.addEventListener('mousemove', mm);
      document.addEventListener('mouseup',   mu);
    });
  }
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initBall);
  } else {
    initBall();
  }
})();
</script></body>
</html>
